# 硬终端和软中断

## 什么是中断
    中断是接受硬件信号的提醒方式，中断分为硬中断和软中断，一般来说硬中断在软中断之前执行

## 什么是硬中断
    硬中断就是内核接受到硬件的中断信号，cpu执行中断处理程序处理这个中断，此时cpu处于中断关闭状态，也就是说不能接其他硬件中断，所以中断必须要短小。

## 什么是软中断
    在硬中断已经说过了，硬中断的时候会关闭中断，所以为了优化中断体验，就把中断拆成了两个部分，第一个部分就是cpu调度中断处理程序处理中断，下半部分是把上半部分没执行完的动作继续执行，这个部分是由内核线程完成，ksoftirqd/0 每个cpu核心上都有一个软中断处理线程，这样就把中断下半部分的行为变成了异步的，优化了并发性能

## 软中断占用cpu过多怎么办
    可以使用cat /proc/softirqs 来查看中断情况 一般来说都是net_tx net_rx比较多 

## 怀疑是网络收发导致的软中断过于频繁怎么办
    1.利用sar -n DEV 1 查看网络收发情况 看下packet的大小
    2.然后利用tcpdump -i etho[网卡] -n[禁止DNS解析] tcp port 80[端口]，如果[S] 状态很多的就是典型的flood sync攻击，这个时候我们应该从防火墙禁掉这个ip 
